{"version":3,"file":"chat.min.js","sources":["../src/chat.js"],"sourcesContent":["import {get_string as getString} from 'core/str';\nimport Templates from 'core/templates';\nimport ajax from 'core/ajax';\n\nconst sendMessage = async () => {\n    const input = document.getElementById('block-learningassist-chat-input');\n    const prompt = input.value;\n    const chatMessages = document.getElementById('chat-messages');\n    const html = `<div class=\"chat-message human-message\">\n                        <div class=\"message-content\">${prompt}</div>\n                     </div>\n                    <div id=\"block-learningassist-delete-me\" class=\"chat-message bot-message\">\n                        <div class=\"message-content\">\n                        <i class=\"fa fa-spinner fa-pulse fa-3x fa-fw\"></i>\n                        <span class=\"sr-only\">Loading...</span></div>\n                     </div>`;\n    chatMessages.innerHTML += html;\n    // Scroll down to the top of new message\n    chatMessages.scrollTop = chatMessages.scrollHeight;\n    input.value = '';\n\n    const courseId = document.getElementById('block-learningassist-courseid').value;\n    const chatType = document.getElementById('block-learningassist-chat-type').value;\n    if (prompt) {\n        const response = await ajax.call([{\n            methodname: 'block_learningassist_chat',\n            args: {\n                courseid: courseId,\n                chattype: chatType,\n                prompt: prompt,\n            },\n        }]);\n        response[0].done((result) => {\n            const deleteMe = document.getElementById('block-learningassist-delete-me');\n            if (deleteMe) {\n                deleteMe.remove();\n            }\n            const bot_html =`<div class=\"chat-message bot-message\">\n                            <div class=\"message-content\">${result}</div>\n                         </div>`\n            chatMessages.innerHTML += bot_html;\n\n            input.focus();\n        }).fail((error) => {\n            alert(error);\n        });\n    }\n};\n\ndocument.getElementById('block-learningassist-chat-send-btn').addEventListener('click', sendMessage);\n\ndocument.getElementById('block-learningassist-chat-input').addEventListener('keydown', (e) => {\n    if (e.key === 'Enter') {\n        e.preventDefault();\n        sendMessage();\n    }\n});"],"names":["_interopRequireDefault","e","__esModule","default","_templates","_ajax","sendMessage","async","input","document","getElementById","prompt","value","chatMessages","html","innerHTML","scrollTop","scrollHeight","courseId","chatType","ajax","call","methodname","args","courseid","chattype","done","result","deleteMe","remove","bot_html","focus","fail","error","alert","addEventListener","key","preventDefault"],"mappings":"8GAE6B,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA,CAD7BG,WAAAJ,uBAAAI,YACAC,MAAAL,uBAAAK,OAEA,MAAMC,YAAcC,UAChB,MAAMC,MAAQC,SAASC,eAAe,mCAChCC,OAASH,MAAMI,MACfC,aAAeJ,SAASC,eAAe,iBACvCI,KAAO,kGACsCH,mXAOnDE,aAAaE,WAAaD,KAE1BD,aAAaG,UAAYH,aAAaI,aACtCT,MAAMI,MAAQ,GAEd,MAAMM,SAAWT,SAASC,eAAe,iCAAiCE,MACpEO,SAAWV,SAASC,eAAe,kCAAkCE,MAC3E,GAAID,OAAQ,QACeS,cAAKC,KAAK,CAAC,CAC9BC,WAAY,4BACZC,KAAM,CACFC,SAAUN,SACVO,SAAUN,SACVR,OAAQA,YAGP,GAAGe,MAAMC,SACd,MAAMC,SAAWnB,SAASC,eAAe,kCACrCkB,UACAA,SAASC,SAEb,MAAMC,SAAU,oGAC+BH,gDAE/Cd,aAAaE,WAAae,SAE1BtB,MAAMuB,OAAO,IACdC,MAAMC,QACLC,MAAMD,MAAM,GAEpB,GAGJxB,SAASC,eAAe,sCAAsCyB,iBAAiB,QAAS7B,aAExFG,SAASC,eAAe,mCAAmCyB,iBAAiB,WAAYlC,IACtE,UAAVA,EAAEmC,MACFnC,EAAEoC,iBACF/B,cACJ,GACD"}