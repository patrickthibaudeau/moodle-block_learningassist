{"version":3,"file":"chat.min.js","sources":["../src/chat.js"],"sourcesContent":["import {get_string as getString} from 'core/str';\n// import Templates from 'core/templates';\nimport ajax from 'core/ajax';\n\nexport const sendMessage = async () => {\n  const input = document.getElementById('block-learningassist-chat-input');\n  const prompt = input.value;\n  if (prompt) {\n    const chatMessages = document.getElementById('chat-messages');\n    const loadingText = await getString('loading', 'block_learningassist');\n\n    const html = `<div class=\"chat-message human-message\">\n                        <div class=\"message-content\">${prompt}</div>\n                     </div>\n                    <div id=\"block-learningassist-delete-me\" class=\"chat-message bot-message\">\n                        <div class=\"message-content\">\n                        <i class=\"fa fa-spinner fa-pulse fa-3x fa-fw\"></i>\n                        <span class=\"sr-only\">${loadingText}</span></div>\n                     </div>`;\n    // Scroll down to the top of new message\n    chatMessages.innerHTML += html;\n    chatMessages.scrollTop = chatMessages.scrollHeight;\n    input.value = '';\n\n    const courseId = document.getElementById('block-learningassist-courseid').value;\n    const chatType = document.getElementById('block-learningassist-chat-type').value;\n    const chatId = document.getElementById('block-learningassist-chatid').value;\n\n    if (prompt) {\n      const response = await ajax.call([{\n        methodname: 'block_learningassist_chat',\n        args: {\n          courseid: courseId,\n          chattype: chatType,\n          prompt: prompt,\n          chatid: chatId\n        },\n      }]);\n      response[0].done((result) => {\n        const deleteMe = document.getElementById('block-learningassist-delete-me');\n        if (deleteMe) {\n          deleteMe.remove();\n        }\n        const bot_html = `<div class=\"chat-message bot-message\">\n                            <div class=\"message-content\">${result}</div>\n                         </div>`;\n        chatMessages.innerHTML += bot_html;\n        input.focus();\n      }).fail((error) => {\n        console.log(error)\n      });\n    }\n  }\n};\n\n\ndocument.getElementById('block-learningassist-chat-send-btn').addEventListener('click', sendMessage);\n\ndocument.getElementById('block-learningassist-chat-input').addEventListener('keydown', (e) => {\n  if (e.key === 'Enter') {\n    e.preventDefault();\n    sendMessage();\n  }\n});\n"],"names":["e","_ajax","__esModule","default","sendMessage","async","input","document","getElementById","prompt","value","chatMessages","html","getString","innerHTML","scrollTop","scrollHeight","courseId","chatType","chatId","ajax","call","methodname","args","courseid","chattype","chatid","done","result","deleteMe","remove","bot_html","focus","fail","error","console","log","_exports","addEventListener","key","preventDefault"],"mappings":"qGAE6B,IAAAA,sFAA7BC,OAA6BD,EAA7BC,QAA6BD,EAAAE,WAAAF,EAAAG,CAAAA,QAAAH,GAEtB,MAAMI,YAAcC,UACzB,MAAMC,MAAQC,SAASC,eAAe,mCAChCC,OAASH,MAAMI,MACrB,GAAID,OAAQ,CACV,MAAME,aAAeJ,SAASC,eAAe,iBAGvCI,KAAO,kGACsCH,qUAHzB,EAAAI,iBAAU,UAAW,oEAW/CF,aAAaG,WAAaF,KAC1BD,aAAaI,UAAYJ,aAAaK,aACtCV,MAAMI,MAAQ,GAEd,MAAMO,SAAWV,SAASC,eAAe,iCAAiCE,MACpEQ,SAAWX,SAASC,eAAe,kCAAkCE,MACrES,OAASZ,SAASC,eAAe,+BAA+BE,MAEtE,GAAID,OAAQ,QACaW,cAAKC,KAAK,CAAC,CAChCC,WAAY,4BACZC,KAAM,CACJC,SAAUP,SACVQ,SAAUP,SACVT,OAAQA,OACRiB,OAAQP,YAGH,GAAGQ,MAAMC,SAChB,MAAMC,SAAWtB,SAASC,eAAe,kCACrCqB,UACFA,SAASC,SAEX,MAAMC,SAAW,oGACkCH,gDAEnDjB,aAAaG,WAAaiB,SAC1BzB,MAAM0B,OAAO,IACZC,MAAMC,QACPC,QAAQC,IAAIF,MAAM,GAEtB,CACF,GACAG,SAAAjC,YAAAA,YAGFG,SAASC,eAAe,sCAAsC8B,iBAAiB,QAASlC,aAExFG,SAASC,eAAe,mCAAmC8B,iBAAiB,WAAYtC,IACxE,UAAVA,EAAEuC,MACJvC,EAAEwC,iBACFpC,cACF,GACC"}