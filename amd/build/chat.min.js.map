{"version":3,"file":"chat.min.js","sources":["../src/chat.js"],"sourcesContent":["import {get_string as getString} from 'core/str';\n// import Templates from 'core/templates';\nimport ajax from 'core/ajax';\n\nexport const sendMessage = async () => {\n    const input = document.getElementById('block-learningassist-chat-input');\n    const prompt = input.value;\n    if (prompt) {\n        const chatMessages = document.getElementById('chat-messages');\n        const loadingText = await getString('loading', 'block_learningassist');\n        const html = `<div class=\"chat-message human-message\">\n                        <div class=\"message-content\">${prompt}</div>\n                     </div>\n                    <div id=\"block-learningassist-delete-me\" class=\"chat-message bot-message\">\n                        <div class=\"message-content\">\n                        <i class=\"fa fa-spinner fa-pulse fa-3x fa-fw\"></i>\n                        <span class=\"sr-only\">${loadingText}</span></div>\n                     </div>`;\n        chatMessages.innerHTML += html;\n        // Scroll down to the top of new message\n        chatMessages.scrollTop = chatMessages.scrollHeight;\n        input.value = '';\n\n        const courseId = document.getElementById('block-learningassist-courseid').value;\n        const chatType = document.getElementById('block-learningassist-chat-type').value;\n        if (prompt) {\n            const response = await ajax.call([{\n                methodname: 'block_learningassist_chat',\n                args: {\n                    courseid: courseId,\n                    chattype: chatType,\n                    prompt: prompt,\n                },\n            }]);\n            response[0].done((result) => {\n                const deleteMe = document.getElementById('block-learningassist-delete-me');\n                if (deleteMe) {\n                    deleteMe.remove();\n                }\n                const bot_html = `<div class=\"chat-message bot-message\">\n                            <div class=\"message-content\">${result}</div>\n                         </div>`;\n                chatMessages.innerHTML += bot_html;\n\n                input.focus();\n            }).fail((error) => {\n                alert(error);\n            });\n        }\n    }\n};\n\n\ndocument.getElementById('block-learningassist-chat-send-btn').addEventListener('click', sendMessage);\n\ndocument.getElementById('block-learningassist-chat-input').addEventListener('keydown', (e) => {\n    if (e.key === 'Enter') {\n        e.preventDefault();\n        sendMessage();\n    }\n});\n"],"names":["e","_ajax","__esModule","default","sendMessage","async","input","document","getElementById","prompt","value","chatMessages","html","getString","innerHTML","scrollTop","scrollHeight","courseId","chatType","ajax","call","methodname","args","courseid","chattype","done","result","deleteMe","remove","bot_html","focus","fail","error","alert","_exports","addEventListener","key","preventDefault"],"mappings":"qGAE6B,IAAAA,sFAA7BC,OAA6BD,EAA7BC,QAA6BD,EAAAE,WAAAF,EAAAG,CAAAA,QAAAH,GAEtB,MAAMI,YAAcC,UACvB,MAAMC,MAAQC,SAASC,eAAe,mCAChCC,OAASH,MAAMI,MACrB,GAAID,OAAQ,CACR,MAAME,aAAeJ,SAASC,eAAe,iBAEvCI,KAAO,kGACkCH,qUAFrB,EAAAI,iBAAU,UAAW,oEAS/CF,aAAaG,WAAaF,KAE1BD,aAAaI,UAAYJ,aAAaK,aACtCV,MAAMI,MAAQ,GAEd,MAAMO,SAAWV,SAASC,eAAe,iCAAiCE,MACpEQ,SAAWX,SAASC,eAAe,kCAAkCE,MAC3E,GAAID,OAAQ,QACeU,cAAKC,KAAK,CAAC,CAC9BC,WAAY,4BACZC,KAAM,CACFC,SAAUN,SACVO,SAAUN,SACVT,OAAQA,YAGP,GAAGgB,MAAMC,SACd,MAAMC,SAAWpB,SAASC,eAAe,kCACrCmB,UACAA,SAASC,SAEb,MAAMC,SAAW,oGAC0BH,gDAE3Cf,aAAaG,WAAae,SAE1BvB,MAAMwB,OAAO,IACdC,MAAMC,QACLC,MAAMD,MAAM,GAEpB,CACJ,GACFE,SAAA9B,YAAAA,YAGFG,SAASC,eAAe,sCAAsC2B,iBAAiB,QAAS/B,aAExFG,SAASC,eAAe,mCAAmC2B,iBAAiB,WAAYnC,IACtE,UAAVA,EAAEoC,MACFpC,EAAEqC,iBACFjC,cACJ,GACD"}