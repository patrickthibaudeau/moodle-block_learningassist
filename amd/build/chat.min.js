define("block_learningassist/chat",["exports","core/str","core/ajax"],(function(_exports,_str,_ajax){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.sendMessage=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const sendMessage=async()=>{const input=document.getElementById("block-learningassist-chat-input"),prompt=input.value;if(prompt){const chatMessages=document.getElementById("chat-messages"),loadingText=await(0,_str.get_string)("loading","block_learningassist"),html='<div class="chat-message human-message">\n                        <div class="message-content">'.concat(prompt,'</div>\n                     </div>\n                    <div id="block-learningassist-delete-me" class="chat-message bot-message">\n                        <div class="message-content">\n                        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>\n                        <span class="sr-only">').concat(loadingText,"</span></div>\n                     </div>");chatMessages.innerHTML+=html,chatMessages.scrollTop=chatMessages.scrollHeight,input.value="";const courseId=document.getElementById("block-learningassist-courseid").value,chatType=document.getElementById("block-learningassist-chat-type").value,chatId=document.getElementById("block-learningassist-chatid").value;if(prompt){(await _ajax.default.call([{methodname:"block_learningassist_chat",args:{courseid:courseId,chattype:chatType,prompt:prompt,chatid:chatId}}]))[0].done((result=>{const deleteMe=document.getElementById("block-learningassist-delete-me");deleteMe&&deleteMe.remove();const bot_html='<div class="chat-message bot-message">\n                            <div class="message-content">'.concat(result,"</div>\n                         </div>");chatMessages.innerHTML+=bot_html,input.focus()})).fail((error=>{console.log(error)}))}}};_exports.sendMessage=sendMessage,window.addEventListener("beforeunload",(()=>{const chatIdElement=document.getElementById("block-learningassist-chatid");if(chatIdElement){const chatId=chatIdElement.value;_ajax.default.call([{methodname:"block_learningassist_clear_chat_history",args:{chatid:chatId}}]).then((()=>{console.log("Chat history cleared")})).catch((error=>{console.error("Error clearing chat history:",error)}))}})),document.getElementById("block-learningassist-chat-send-btn").addEventListener("click",sendMessage),document.getElementById("block-learningassist-chat-input").addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),sendMessage())}))}));

//# sourceMappingURL=chat.min.js.map